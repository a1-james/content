
#### Playbooks

##### CVE-2021-22893 - Pulse Connect Secure RCE

- New: On April 20th, a new Remote Code Execution vulnerability in Pulse Connect Secure was disclosed. 
The reference number for the vulnerability is CVE-2021-22893 with the CVSS Score of 10.0. 
This playbook should be trigger manually and includes the following tasks: 

* Enrich related known CVEs and Malware Hashes used by the suspected APT actor.
* Search for unpatched endpoints vulnerable to the exploits.
* Search network facing system using Expanse for relevant issues.
* Indicators and known webshells hunting using SIEM products.
* Block indicators automatically or manually.
* Provide different mitigations that has been publicly published such as:
    * Patches
    * Workarounds
    * Yara and Snort Rules

Note: This is a beta playbook, which lets you implement and test pre-release software. Since the playbook is beta, it might contain bugs. Updates to the pack during the beta phase might include non-backward compatible features. We appreciate your feedback on the quality and usability of the pack to help us identify issues, fix them, and continually improve.

More information:
[Exploitation of Pulse Connect Secure Vulnerabilities](https://us-cert.cisa.gov/ncas/alerts/aa21-110a)

##### Kaseya VSA  0-day - REvil Ransomware Supply Chain Attack

- New: On July 2nd, Kaseya company has experienced an attack against the VSA (Virtual System/Server Administrator) product. Kaseya customers pointed out a ransomware outbreak in their environments.
Further investigation revealed that REvil group exploited VSA zero-day vulnerabilities for authentication bypass and arbitrary command execution. This allowed the attacker to deploy ransomware on Kaseya customers' endpoints.

This playbook should be trigger manually and includes the following tasks: 

* Collect related known indicators from several sources.
* Indicators, PS commands, Registry changes and known HTTP requests hunting using PAN-OS, Cortex XDR and SIEM products.
    * Splunk advanced queries can be modified through the playbook inputs.
    * QRadar query is done using Reference Set and "QRadar Indicator Hunting V2" playbook
* Search for internet facing Kaseya VSA servers using Xpanse.
* Block indicators automatically or manually.
* Provide advanced hunting and detection capabilities.
* Mitigation using Kaseya On-Premises and SaaS patch.

More information:
[Kaseya Incident Overview & Technical Details](https://helpdesk.kaseya.com/hc/en-gb/articles/4403584098961)

Note: This is a beta playbook, which lets you implement and test pre-release software. Since the playbook is beta, it might contain bugs. Updates to the pack during the beta phase might include non-backward compatible features. We appreciate your feedback on the quality and usability of the pack to help us identify issues, fix them, and continually improve.
- Modified `fromversion: 6.0.0` and `toversion: 6.4.9` 
- Added new configuration to support `fromversion:6.5.0` and upwards

##### HAFNIUM - Exchange 0-day exploits

- Replaced the **Block Indicators - Generic v2** sub-playbook with the new **Block Indicators - Generic v3** playbook. (Available from Cortex XSOAR 6.5.0).
- Added input `AutoBlockIndicators` - This input determines if to block the indicators automatically or manually using the sub-playbook `Block Indicators - Generic v3`. (Available from Cortex XSOAR 6.5.0).
- Added input `UserVerification` - This input determines if blocking IPs is should be done with or without user verification.  The IPs blocking is done by using the sub-playbook `Block Indicators - Generic v3`. (Available from Cortex XSOAR 6.5.0). 
- Modified `fromversion: 6.0.0` and `toversion: 6.4.9` 
- Added new configuration to support `fromversion:6.5.0` and upwards

##### SolarStorm and SUNBURST Hunting and Response Playbook

- Replaced the **Block Indicators - Generic v2** sub-playbook with the new **Block Indicators - Generic v3** playbook. (Available from Cortex XSOAR 6.5.0).
- Added input `AutoBlockIndicators` - This input determines if to block the indicators automatically or manually using the sub-playbook `Block Indicators - Generic v3`. (Available from Cortex XSOAR 6.5.0).
- Added input `UserVerification` - This input determines if blocking IPs is should be done with or without user verification.  The IPs blocking is done by using the sub-playbook `Block Indicators - Generic v3`. (Available from Cortex XSOAR 6.5.0).
- Removed expanse-get-risky-flows and expanse-list-risk-rules as they are EOD with no suitable replacements
- Modified `fromversion: 6.0.0` and `toversion: 6.4.9` 
- Added new configuration to support `fromversion:6.5.0` and upwards
- 
##### NOBELIUM - wide scale APT29 spear-phishing

- Replaced the **Block Indicators - Generic v2** sub-playbook with the new **Block Indicators - Generic v3** playbook. (Available from Cortex XSOAR 6.5.0).
- Added input `AutoBlockIndicators` - This input determines if to block the indicators automatically or manually using the sub-playbook `Block Indicators - Generic v3`. (Available from Cortex XSOAR 6.5.0).
- Added input `UserVerification` - This input determines if blocking IPs is should be done with or without user verification.  The IPs blocking is done by using the sub-playbook `Block Indicators - Generic v3`. (Available from Cortex XSOAR 6.5.0).
- Modified `fromversion: 6.0.0` and `toversion: 6.4.9` 
- Added new configuration to support `fromversion:6.5.0` and upwards