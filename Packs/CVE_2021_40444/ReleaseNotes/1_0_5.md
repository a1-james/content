#### Playbooks

##### New: CVE-2021-40444 - MSHTML RCE

- New: CVE-2021-4044 refers to the MSHTML engine, that has been found vulnerable to arbitrary code execution by a specially crafted Microsoft Office document or rich text format file. 

Mitigations:
* Microsoft official patch addressing CVE-2021-40444 
* Several workarounds suggested by Microsoft.

Researchers have validated this attack triggered in Windows Explorer with “Preview Mode” enabled, even in just a rich-text format RTF file (not an Office file and without ActiveX). This indicates it can be exploited even without opening the file and this invalidates Microsoft’s workaround mitigation mentioned above.

This playbook should be trigger manually and includes the following tasks: 

* Collect related known indicators from several sources.
* Indicators, Files and Process creation patterns hunting using PAN-OS, Cortex XDR and SIEM products.
* Block indicators automatically or manually.
* Provide workarounds and detection capabilities.
* Microsoft official CVE-2021-40444 patch.

More information:
[Microsoft MSHTML Remote Code Execution Vulnerability](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444)

Note: This is a beta playbook, which lets you implement and test pre-release software. Since the playbook is beta, it might contain bugs. Updates to the pack during the beta phase might include non-backward compatible features. We appreciate your feedback on the quality and usability of the pack to help us identify issues, fix them, and continually improve.

##### CVE-2021-40444 - MSHTML RCE

- Replaced the **Block Indicators - Generic v2** sub-playbook with the new **Block Indicators - Generic v3** playbook. (Available from Cortex XSOAR 6.5.0).
- Added the *AutoBlockIndicators* input. This input determines whether to block the indicators automatically or manually using the **Block Indicators - Generic v3** sub-playbook. (Available from Cortex XSOAR 6.5.0).
- Added the *UserVerification* input. This input determines whether blocking IPs should be done with or without user verification.  The IPs blocking is done by using the **Block Indicators - Generic v3** sub-playbook. (Available from Cortex XSOAR 6.5.0).
- Added configuration `fromversion: 5.5.0` and `toversion: 6.4.9`
- Added configuration `fromversion: 6.5.0`